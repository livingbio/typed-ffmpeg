<h3 class="section"><a href="#toc-afir-1">8.25 afir</a></h3>

<p>Apply an arbitrary Finite Impulse Response filter.
</p>
<p>This filter is designed for applying long FIR filters,
up to 60 seconds long.
</p>
<p>It can be used as component for digital crossover filters,
room equalization, cross talk cancellation, wavefield synthesis,
auralization, ambiophonics, ambisonics and spatialization.
</p>
<p>This filter uses the streams higher than first one as FIR coefficients.
If the non-first stream holds a single channel, it will be used
for all input channels in the first stream, otherwise
the number of channels in the non-first stream must be same as
the number of channels in the first stream.
</p>
<p>It accepts the following parameters:
</p>
<dl compact="compact">
<dt><samp>dry</samp></dt>
<dd><p>Set dry gain. This sets input gain.
</p>
</dd>
<dt><samp>wet</samp></dt>
<dd><p>Set wet gain. This sets final output gain.
</p>
</dd>
<dt><samp>length</samp></dt>
<dd><p>Set Impulse Response filter length. Default is 1, which means whole IR is processed.
</p>
</dd>
<dt><samp>gtype</samp></dt>
<dd><p>This option is deprecated, and does nothing.
</p>
</dd>
<dt><samp>irnorm</samp></dt>
<dd><p>Set norm to be applied to IR coefficients before filtering.
Allowed range is from <var>-1</var> to <var>2</var>.
IR coefficients are normalized with calculated vector norm set by this option.
For negative values, no norm is calculated, and IR coefficients are not modified at all.
Default is <var>1</var>.
</p>
</dd>
<dt><samp>irlink</samp></dt>
<dd><p>For multichannel IR if this option is set to <var>true</var>, all IR channels will be
normalized with maximal measured gain of all IR channels coefficients as set by <code>irnorm</code> option.
When disabled, all IR coefficients in each IR channel will be normalized independently.
Default is <var>true</var>.
</p>
</dd>
<dt><samp>irgain</samp></dt>
<dd><p>Set gain to be applied to IR coefficients before filtering.
Allowed range is 0 to 1. This gain is applied after any gain applied with <var>irnorm</var> option.
</p>
</dd>
<dt><samp>irfmt</samp></dt>
<dd><p>Set format of IR stream. Can be <code>mono</code> or <code>input</code>.
Default is <code>input</code>.
</p>
</dd>
<dt><samp>maxir</samp></dt>
<dd><p>Set max allowed Impulse Response filter duration in seconds. Default is 30 seconds.
Allowed range is 0.1 to 60 seconds.
</p>
</dd>
<dt><samp>response</samp></dt>
<dd><p>This option is deprecated, and does nothing.
</p>
</dd>
<dt><samp>channel</samp></dt>
<dd><p>This option is deprecated, and does nothing.
</p>
</dd>
<dt><samp>size</samp></dt>
<dd><p>This option is deprecated, and does nothing.
</p>
</dd>
<dt><samp>rate</samp></dt>
<dd><p>This option is deprecated, and does nothing.
</p>
</dd>
<dt><samp>minp</samp></dt>
<dd><p>Set minimal partition size used for convolution. Default is <var>8192</var>.
Allowed range is from <var>1</var> to <var>65536</var>.
Lower values decreases latency at cost of higher CPU usage.
</p>
</dd>
<dt><samp>maxp</samp></dt>
<dd><p>Set maximal partition size used for convolution. Default is <var>8192</var>.
Allowed range is from <var>8</var> to <var>65536</var>.
Lower values may increase CPU usage.
</p>
</dd>
<dt><samp>nbirs</samp></dt>
<dd><p>Set number of input impulse responses streams which will be switchable at runtime.
Allowed range is from <var>1</var> to <var>32</var>. Default is <var>1</var>.
</p>
</dd>
<dt><samp>ir</samp></dt>
<dd><p>Set IR stream which will be used for convolution, starting from <var>0</var>, should always be
lower than supplied value by <code>nbirs</code> option. Default is <var>0</var>.
This option can be changed at runtime via <a href="#commands">commands</a>.
</p>
</dd>
<dt><samp>precision</samp></dt>
<dd><p>Set which precision to use when processing samples.
</p>
<dl compact="compact">
<dt><samp>auto</samp></dt>
<dd><p>Auto pick internal sample format depending on other filters.
</p>
</dd>
<dt><samp>float</samp></dt>
<dd><p>Always use single-floating point precision sample format.
</p>
</dd>
<dt><samp>double</samp></dt>
<dd><p>Always use double-floating point precision sample format.
</p></dd>
</dl>

<p>Default value is auto.
</p>
</dd>
<dt><samp>irload</samp></dt>
<dd><p>Set when to load IR stream. Can be <code>init</code> or <code>access</code>.
First one load and prepares all IRs on initialization, second one
once on first access of specific IR.
Default is <code>init</code>.
</p></dd>
</dl>
